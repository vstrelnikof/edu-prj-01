"""
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ–π–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ–º—ñ—á–Ω–∏–∫–∞
–ü–æ–∫–∞–∑—É—î –æ—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –ø—Ä–æ–≥—Ä–∞–º–∏
"""
from contacts import AddressBook, Record
from notes import NoteBook, Note
from datetime import datetime, timedelta


def demo():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É"""
    
    print("=" * 60)
    print("üìö –î–ï–ú–û–ù–°–¢–†–ê–¶–Ü–Ø –ü–ï–†–°–û–ù–ê–õ–¨–ù–û–ì–û –ü–û–ú–Ü–ß–ù–ò–ö–ê")
    print("=" * 60)
    
    # ==================== –ö–û–ù–¢–ê–ö–¢–ò ====================
    print("\nüîπ –†–û–ë–û–¢–ê –ó –ö–û–ù–¢–ê–ö–¢–ê–ú–ò\n")
    
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞–¥—Ä–µ—Å–Ω–æ—ó –∫–Ω–∏–≥–∏
    book = AddressBook()
    
    # –î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤
    print("1. –î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤:")
    print("-" * 40)
    
    # –ö–æ–Ω—Ç–∞–∫—Ç 1
    record1 = Record("–Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ")
    record1.add_phone("0991234567")
    record1.add_email("ivan@example.com")
    record1.add_address("–≤—É–ª. –®–µ–≤—á–µ–Ω–∫–∞, 15, –ö–∏—ó–≤")
    
    # –î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ 5 –¥–Ω—ñ–≤
    future_date = datetime.now().date() + timedelta(days=5)
    birthday1 = future_date.strftime("%d.%m.") + "1990"
    record1.add_birthday(birthday1)
    
    book.add_record(record1)
    print(f"‚úì {record1}")
    
    # –ö–æ–Ω—Ç–∞–∫—Ç 2
    record2 = Record("–ú–∞—Ä—ñ—è –ö–æ–≤–∞–ª—å")
    record2.add_phone("0501234567")
    record2.add_phone("0631234567")
    record2.add_email("maria@example.com")
    record2.add_address("–ø—Ä. –ü–µ—Ä–µ–º–æ–≥–∏, 25, –õ—å–≤—ñ–≤")
    
    # –î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ 15 –¥–Ω—ñ–≤
    future_date2 = datetime.now().date() + timedelta(days=15)
    birthday2 = future_date2.strftime("%d.%m.") + "1985"
    record2.add_birthday(birthday2)
    
    book.add_record(record2)
    print(f"‚úì {record2}")
    
    # –ö–æ–Ω—Ç–∞–∫—Ç 3
    record3 = Record("–û–ª–µ–∫—Å–∞–Ω–¥—Ä –°–∏–¥–æ—Ä–µ–Ω–∫–æ")
    record3.add_phone("0671234567")
    record3.add_email("alex@example.com")
    book.add_record(record3)
    print(f"‚úì {record3}")
    
    # –ü–æ—à—É–∫ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤
    print("\n2. –ü–æ—à—É–∫ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤ –∑–∞ –∑–∞–ø–∏—Ç–æ–º '–ú–∞—Ä—ñ—è':")
    print("-" * 40)
    results = book.search("–ú–∞—Ä—ñ—è")
    for r in results:
        print(f"‚úì –ó–Ω–∞–π–¥–µ–Ω–æ: {r.name.value}")
    
    # –ü–æ—à—É–∫ –∑–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
    print("\n3. –ü–æ—à—É–∫ –∑–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º '0991234567':")
    print("-" * 40)
    results = book.search("0991234567")
    for r in results:
        print(f"‚úì –ó–Ω–∞–π–¥–µ–Ω–æ: {r.name.value}, {r.phones[0].value}")
    
    # –î–Ω—ñ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
    print("\n4. –ö–æ–Ω—Ç–∞–∫—Ç–∏ –∑ –¥–Ω—è–º–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —É –Ω–∞–π–±–ª–∏–∂—á—ñ 30 –¥–Ω—ñ–≤:")
    print("-" * 40)
    birthdays = book.get_birthdays_in_days(30)
    for record, days in birthdays:
        if days == 0:
            print(f"üéâ –°–¨–û–ì–û–î–ù–Ü: {record.name.value}")
        elif days == 1:
            print(f"üéÇ –ó–ê–í–¢–†–ê: {record.name.value}")
        else:
            print(f"üìÖ –ß–µ—Ä–µ–∑ {days} –¥–Ω—ñ–≤: {record.name.value}")
    
    # –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—É
    print("\n5. –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—É:")
    print("-" * 40)
    record1.add_phone("0931234567")
    print(f"‚úì –î–æ–¥–∞–Ω–æ –Ω–æ–≤–∏–π —Ç–µ–ª–µ—Ñ–æ–Ω –¥–ª—è {record1.name.value}")
    print(f"   –¢–µ–ø–µ—Ä —É –∫–æ–Ω—Ç–∞–∫—Ç—É {len(record1.phones)} —Ç–µ–ª–µ—Ñ–æ–Ω–∏")
    
    # –í–∏–¥–∞–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—É
    print("\n6. –í–∏–¥–∞–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—É:")
    print("-" * 40)
    book.delete("–û–ª–µ–∫—Å–∞–Ω–¥—Ä –°–∏–¥–æ—Ä–µ–Ω–∫–æ")
    print(f"‚úì –ö–æ–Ω—Ç–∞–∫—Ç '–û–ª–µ–∫—Å–∞–Ω–¥—Ä –°–∏–¥–æ—Ä–µ–Ω–∫–æ' –≤–∏–¥–∞–ª–µ–Ω–æ")
    print(f"   –ó–∞–ª–∏—à–∏–ª–æ—Å—å –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤: {len(book.data)}")
    
    # ==================== –ù–û–¢–ê–¢–ö–ò ====================
    print("\n\nüîπ –†–û–ë–û–¢–ê –ó –ù–û–¢–ê–¢–ö–ê–ú–ò\n")
    
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–ª–æ–∫–Ω–æ—Ç—É
    notebook = NoteBook()
    
    # –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ—Ç–∞—Ç–æ–∫
    print("1. –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ—Ç–∞—Ç–æ–∫:")
    print("-" * 40)
    
    note1 = Note("–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫", "–ú–æ–ª–æ–∫–æ, —Ö–ª—ñ–±, —è–π—Ü—è, –º–∞—Å–ª–æ")
    note1.add_tag("–ø–æ–∫—É–ø–∫–∏")
    note1.add_tag("–æ—Å–æ–±–∏—Å—Ç–µ")
    notebook.add_note(note1)
    print(f"‚úì –î–æ–¥–∞–Ω–æ: {note1.title}")
    print(f"   –¢–µ–≥–∏: {', '.join(note1.tags)}")
    
    note2 = Note("–Ü–¥–µ—ó –¥–ª—è –ø—Ä–æ–µ–∫—Ç—É", "1. –î–æ–¥–∞—Ç–∏ –µ–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤\n2. –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º\n3. –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑ —Ö–º–∞—Ä–æ—é")
    note2.add_tag("—Ä–æ–±–æ—Ç–∞")
    note2.add_tag("–ø—Ä–æ–µ–∫—Ç")
    note2.add_tag("—ñ–¥–µ—ó")
    notebook.add_note(note2)
    print(f"‚úì –î–æ–¥–∞–Ω–æ: {note2.title}")
    print(f"   –¢–µ–≥–∏: {', '.join(note2.tags)}")
    
    note3 = Note("–ö–Ω–∏–≥–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è", "- '1984' –î–∂–æ—Ä–¥–∂ –û—Ä–≤–µ–ª–ª\n- '–ú–∞–π—Å—Ç–µ—Ä —ñ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞' –ë—É–ª–≥–∞–∫–æ–≤")
    note3.add_tag("–∫–Ω–∏–≥–∏")
    note3.add_tag("–æ—Å–æ–±–∏—Å—Ç–µ")
    notebook.add_note(note3)
    print(f"‚úì –î–æ–¥–∞–Ω–æ: {note3.title}")
    print(f"   –¢–µ–≥–∏: {', '.join(note3.tags)}")
    
    note4 = Note("–ó—É—Å—Ç—Ä—ñ—á –∫–æ–º–∞–Ω–¥–∏", "–û–±–≥–æ–≤–æ—Ä–∏—Ç–∏ –ø–ª–∞–Ω –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å–ø—Ä–∏–Ω—Ç")
    note4.add_tag("—Ä–æ–±–æ—Ç–∞")
    note4.add_tag("–∑—É—Å—Ç—Ä—ñ—á—ñ")
    notebook.add_note(note4)
    print(f"‚úì –î–æ–¥–∞–Ω–æ: {note4.title}")
    print(f"   –¢–µ–≥–∏: {', '.join(note4.tags)}")
    
    # –ü–æ—à—É–∫ –Ω–æ—Ç–∞—Ç–æ–∫
    print("\n2. –ü–æ—à—É–∫ –Ω–æ—Ç–∞—Ç–æ–∫ –∑–∞ –∑–∞–ø–∏—Ç–æ–º '–ø—Ä–æ–µ–∫—Ç':")
    print("-" * 40)
    results = notebook.search("–ø—Ä–æ–µ–∫—Ç")
    for idx, note in results:
        print(f"‚úì –ó–Ω–∞–π–¥–µ–Ω–æ: {note.title}")
    
    # –ü–æ—à—É–∫ –∑–∞ —Ç–µ–≥–æ–º
    print("\n3. –ü–æ—à—É–∫ –Ω–æ—Ç–∞—Ç–æ–∫ –∑–∞ —Ç–µ–≥–æ–º '—Ä–æ–±–æ—Ç–∞':")
    print("-" * 40)
    results = notebook.search_by_tag("—Ä–æ–±–æ—Ç–∞")
    print(f"‚úì –ó–Ω–∞–π–¥–µ–Ω–æ {len(results)} –Ω–æ—Ç–∞—Ç–æ–∫:")
    for idx, note in results:
        print(f"   ‚Ä¢ {note.title}")
    
    # –í—Å—ñ —Ç–µ–≥–∏
    print("\n4. –í—Å—ñ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ —Ç–µ–≥–∏:")
    print("-" * 40)
    tags = notebook.get_all_tags()
    print(f"‚úì –í—Å—å–æ–≥–æ —Ç–µ–≥—ñ–≤: {len(tags)}")
    for tag in tags:
        count = sum(1 for note in notebook.notes if tag in note.tags)
        print(f"   ‚Ä¢ {tag} ({count} –Ω–æ—Ç–∞—Ç–æ–∫)")
    
    # –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –Ω–æ—Ç–∞—Ç–∫–∏
    print("\n5. –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –Ω–æ—Ç–∞—Ç–∫–∏:")
    print("-" * 40)
    note1.edit(content="–ú–æ–ª–æ–∫–æ, —Ö–ª—ñ–±, —è–π—Ü—è, –º–∞—Å–ª–æ, —Å–∏—Ä, –∫–æ–≤–±–∞—Å–∞")
    print(f"‚úì –û–Ω–æ–≤–ª–µ–Ω–æ: {note1.title}")
    print(f"   –ù–æ–≤–∏–π —Ç–µ–∫—Å—Ç: {note1.content}")
    
    # –í–∏–¥–∞–ª–µ–Ω–Ω—è –Ω–æ—Ç–∞—Ç–∫–∏
    print("\n6. –í–∏–¥–∞–ª–µ–Ω–Ω—è –Ω–æ—Ç–∞—Ç–∫–∏:")
    print("-" * 40)
    notebook.delete_note(0)
    print(f"‚úì –ü–µ—Ä—à—É –Ω–æ—Ç–∞—Ç–∫—É –≤–∏–¥–∞–ª–µ–Ω–æ")
    print(f"   –ó–∞–ª–∏—à–∏–ª–æ—Å—å –Ω–æ—Ç–∞—Ç–æ–∫: {len(notebook.notes)}")
    
    # ==================== –í–ê–õ–Ü–î–ê–¶–Ü–Ø ====================
    print("\n\nüîπ –î–ï–ú–û–ù–°–¢–†–ê–¶–Ü–Ø –í–ê–õ–Ü–î–ê–¶–Ü–á\n")
    
    print("1. –°–ø—Ä–æ–±–∞ –¥–æ–¥–∞—Ç–∏ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ç–µ–ª–µ—Ñ–æ–Ω:")
    print("-" * 40)
    try:
        test_record = Record("–¢–µ—Å—Ç–æ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á")
        test_record.add_phone("099-123-45-67")  # –ù–µ–≤–∞–ª—ñ–¥–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç
    except ValueError as e:
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
    
    print("\n2. –°–ø—Ä–æ–±–∞ –¥–æ–¥–∞—Ç–∏ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π email:")
    print("-" * 40)
    try:
        test_record = Record("–¢–µ—Å—Ç–æ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á")
        test_record.add_email("invalid.email")  # –ù–µ–≤–∞–ª—ñ–¥–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç
    except ValueError as e:
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
    
    print("\n3. –°–ø—Ä–æ–±–∞ –¥–æ–¥–∞—Ç–∏ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω—É –¥–∞—Ç—É:")
    print("-" * 40)
    try:
        test_record = Record("–¢–µ—Å—Ç–æ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á")
        test_record.add_birthday("32.13.2020")  # –ù–µ–≤–∞–ª—ñ–¥–Ω–∞ –¥–∞—Ç–∞
    except ValueError as e:
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
    
    # ==================== –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø ====================
    print("\n\nüîπ –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø –î–ê–ù–ò–• (JSON FORMAT)\n")
    print("-" * 40)
    
    try:
        book.save()
        print("‚úì –ö–æ–Ω—Ç–∞–∫—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –Ω–∞ –¥–∏—Å–∫ —É JSON —Ñ–æ—Ä–º–∞—Ç—ñ")
        print(f"   –§–∞–π–ª: {book.data_file}")
        
        notebook.save()
        print("‚úì –ù–æ—Ç–∞—Ç–∫–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –Ω–∞ –¥–∏—Å–∫ —É JSON —Ñ–æ—Ä–º–∞—Ç—ñ")
        print(f"   –§–∞–π–ª: {notebook.data_file}")
        
        print("\nüí° JSON —Ñ–∞–π–ª–∏ –ª–µ–≥–∫–æ —á–∏—Ç–∞—Ç–∏ —Ç–∞ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ –≤—Ä—É—á–Ω—É!")
        print("   –í—ñ–¥–∫—Ä–∏–π—Ç–µ —ó—Ö —É —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É.")
    except Exception as e:
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: {e}")
    
    # ==================== –ü–Ü–î–°–£–ú–û–ö ====================
    print("\n" + "=" * 60)
    print("üìä –ü–Ü–î–°–£–ú–û–ö –î–ï–ú–û–ù–°–¢–†–ê–¶–Ü–á")
    print("=" * 60)
    print(f"\n‚úì –í—Å—å–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤: {len(book.data)}")
    print(f"‚úì –í—Å—å–æ–≥–æ –Ω–æ—Ç–∞—Ç–æ–∫: {len(notebook.notes)}")
    print(f"‚úì –í—Å—å–æ–≥–æ —Ç–µ–≥—ñ–≤: {len(notebook.get_all_tags())}")
    print(f"‚úì –ö–æ–Ω—Ç–∞–∫—Ç—ñ–≤ –∑ –¥–Ω—è–º–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è: {len(birthdays)}")
    
    print("\nüîÑ –§–æ—Ä–º–∞—Ç –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: JSON (–∑–∞–º—ñ—Å—Ç—å pickle)")
    print("   –ü–µ—Ä–µ–≤–∞–≥–∏ JSON:")
    print("   ‚Ä¢ –ß–∏—Ç–∞–±–µ–ª—å–Ω—ñ—Å—Ç—å - –º–æ–∂–Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∏ —É –±—É–¥—å-—è–∫–æ–º—É —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ")
    print("   ‚Ä¢ –ü–µ—Ä–µ–Ω–æ—Å–∏–º—ñ—Å—Ç—å - –ø—Ä–∞—Ü—é—î –Ω–∞ –≤—Å—ñ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö")
    print("   ‚Ä¢ –ë–µ–∑–ø–µ–∫–∞ - –ø—Ä–æ—Å—Ç—ñ—à–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É")
    print("   ‚Ä¢ –°—É–º—ñ—Å–Ω—ñ—Å—Ç—å - –ª–µ–≥–∫–æ —ñ–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ –∑ —ñ–Ω—à–∏–º–∏ –ø—Ä–æ–≥—Ä–∞–º–∞–º–∏")
    
    print("\n‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø—ñ—à–Ω–æ!")
    print("\nüí° –©–æ–± –ø–æ—á–∞—Ç–∏ —Ä–æ–±–æ—Ç—É –∑ –ø–æ–º—ñ—á–Ω–∏–∫–æ–º, –∑–∞–ø—É—Å—Ç—ñ—Ç—å: python main.py")
    print("=" * 60)


if __name__ == "__main__":
    demo()
